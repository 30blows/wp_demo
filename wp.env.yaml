core_plugin: docker-swarm
service_discovery_plugin: docker-swarm
service_discovery_auto: true

plugin_config:
    docker-swarm:
        volumes:
            db_data:
                from: sks_db_data
            wp_data:
                from: sks_wp_data

vars:
    db_port:      "3306"
    db_user:      wordpress
    db_password:  wordpress
    db_database:  wordpress
    db_secret:    my_secret

quality_gates:
    mariadb:
        images:
            - mariadb
            - mariadb:*
        steps:
            - probe:
                image:   opsani/probe-mariadb
                action:  check_access
                label:   "Probe mariadb check_access port ${db_port}"
                arguments:
                    user: "${db_user}"
                    password: "${db_password}"
                    database: "${db_database}"
                    port: "${db_port}"
